function create_span(){fontchecker_a=document.createElement("span"),document.body.appendChild(fontchecker_a),fontchecker_a.style.fontFamily="Arial,monospace",fontchecker_a.style.margin="0px",fontchecker_a.style.padding="0px",fontchecker_a.style.fontSize="32px",fontchecker_a.style.position="absolute",fontchecker_a.style.top="-999px",fontchecker_a.style.left="-999px",fontchecker_a.innerHTML="Font Checker SPAN-A",fontchecker_b=document.createElement("span"),document.body.appendChild(fontchecker_b),fontchecker_b.style.fontFamily="Arial,monospace",fontchecker_b.style.margin="0px",fontchecker_b.style.padding="0px",fontchecker_b.style.fontSize="32px",fontchecker_b.style.position="absolute",fontchecker_b.style.top="-999px",fontchecker_b.style.left="-999px",fontchecker_b.innerHTML="Font Checker SPAN-B"}function checkfont(a){create_span();var b="ERROR",c=/[\,\.\/\;\'\[\]\`\<\>\\\?\:\"\{\}\|\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+ ]/g;return a=a.replace(c,""),fontchecker_a.style.fontFamily=a+",monospace",fontchecker_b.style.fontFamily="monospace",fontchecker_a.innerHTML="random_words_#_!@#$^&*()_+mdvejreu_RANDOM_WORDS",fontchecker_b.innerHTML=fontchecker_a.innerHTML,parseInt(fontchecker_a.offsetWidth,10)==parseInt(fontchecker_b.offsetWidth,10)&&Number(fontchecker_a.offsetHeight)==Number(fontchecker_b.offsetHeight)?(fontchecker_a.style.fontFamily=a+",Arial",fontchecker_b.style.fontFamily="Arial",b=Number(fontchecker_a.offsetWidth)==Number(fontchecker_b.offsetWidth)&&Number(fontchecker_a.offsetHeight)==Number(fontchecker_b.offsetHeight)?!1:!0):b=!0,fontchecker_a.innerHTML="",fontchecker_a.outerHTML="",fontchecker_b.innerHTML="",fontchecker_b.outerHTML="",b}var title="Perfect Font",preId="perfectfont-",mouseX,mouseY,lDivX,lDivY,move=!1,domElements=["window","header","list-container","list","detail","toggle-transparency","selection","search-container","available-container","available","preference","value"],preferenceNames=["Size","Weight",'Spacing <span class="perfectfont">(Letter)</span>','Spacing <span class="perfectfont">(Word)</span>','Height <span class="perfectfont">(Line)</span>',"Color"],valueTypes=["number","number","number","number","number","color"],valueIds=["fontSize","fontWeight","letterSpacing","wordSpacing","lineHeight","color"],fontStyles=["serif","sans-serif","handwriting","display","monospace"],defaults={draggable:!0,maximized:!1,docked:!1,transparent:!1,controlButton:!1,fonts:{googleWebFonts:{serif:!0,sansSerif:!0,handwriting:!0,display:!0,monospace:!0}}},perfectfont={config:void 0,selectionUsedFonts:[],usedFonts:[],selectionAdded:0,selectedUsedFont:null,selectedUsedFontId:null,dom:{},init:function(a){this.config=a,this.config||(this.config=defaults),this.initWindow(),this.initFonts()},initWindow:function(){var a=document.createElement("div");a.id=preId+"window",document.body.appendChild(a);var b='<span id="perfectfont-close" onclick="perfectfont.close()"></span><span id="perfectfont-min" onclick="perfectfont.close()"></span><span id="perfectfont-max" onclick="perfectfont.maximize()"></span>';a.innerHTML+='<div id="'+preId+'header">'+b+title+"</div>",a.innerHTML+='<div id="'+preId+'list-container"><div id="'+preId+'toggle-transparency" onclick="perfectfont.toggleTransparency()">Transparency</div><div id="'+preId+'selection" onmousedown="perfectfont.addSelectionToList()">Add Selection</div><div id="'+preId+'element" onmousedown="perfectfont.addElementToList()">Add Element</div><ul id="'+preId+'list"></ul></div>';var c="";fontStyles.forEach(function(a){perfectfont.config.fonts.googleWebFonts[a.replace("-s","S")]&&(c+='<span class="perfectfont active" onclick="perfectfont.filterAvailableFonts(this)">'+a+"</span>")}),a.innerHTML+='<div id="'+preId+'available-container"><div>'+c+'</div><div id="'+preId+'search-container"><input id="'+preId+'search" placeholder="Search ..." type="text" onkeyup="perfectfont.searchAvailableFont(this, this.value)"></div><select id="'+preId+'available" onchange="perfectfont.updateUsedFont(this)"></div>',a.innerHTML+='<div id="'+preId+'detail"></div>',this.initDom(),this.initDetails(),this.initWindowTools()},initDom:function(a){a?valueIds.forEach(function(a){perfectfont.dom[a]=document.getElementById(preId+a)}):domElements.forEach(function(a){perfectfont.dom[a]=document.getElementById(preId+a)})},initWindowTools:function(){this.config.draggable&&this.enableDragDrop()},initDetails:function(){var a="",b="";this.dom.detail.innerHTML+='<div id="'+preId+'preference"></div><div id="'+preId+'value"></div>';for(var c=0;c<preferenceNames.length;++c)a+='<li class="perfectfont">'+preferenceNames[c]+"</li>",b+='<input id="'+preId+valueIds[c]+'" type="'+valueTypes[c]+'" onchange="perfectfont.updateUsedFontDetail(this)"',"fontWeight"==valueIds[c]&&(b+='min="100" max="900" step="100"'),b+=">";this.initDom(),this.dom.preference.innerHTML+=a,this.dom.value.innerHTML+=b,this.initDom(!0)},initFonts:function(){this.initUsedFonts(),this.usedFonts.forEach(function(a){perfectfont.addFontToList(a)});var a=this.config.fonts.googleWebFonts;this.getGoogleWebFonts(a.serif,a.sansSerif,a.handwriting,a.display,a.monospace)},initUsedFonts:function(){for(var a=[],b=[],c=this.getElementsWithInnerText(),d=c.length,e=0;d>e;++e){var f=c[e];if(-1!=f.className.indexOf("perfectfont")||-1!=f.id.indexOf("perfectfont"))break;var g=this.getStyleProperty(f,"font-family"),h=a.indexOf(g);if(-1!=h)this.usedFonts[h].addDomElement(f);else{a.push(g);var g=this.getRenderedFont(g);b.push(g);var i=this.generateFontDetails(f),j=new UsedFont;j.init(b.length-1,g,i),this.usedFonts.push(j),this.usedFonts[b.length-1].addDomElement(f)}}},generateFontDetails:function(a){var b={fontWeight:"normal"==this.getStyleProperty(a,"font-weight")?400:this.getStyleProperty(a,"font-weight"),fontSize:this.getStyleProperty(a,"font-size"),letterSpacing:"normal"==this.getStyleProperty(a,"letter-spacing")?0:this.getStyleProperty(a,"font-weight"),wordSpacing:this.getStyleProperty(a,"word-spacing"),lineHeight:this.getStyleProperty(a,"line-height"),color:this.getStyleProperty(a,"color"),fontStyle:this.getStyleProperty(a,"font-style"),fontVariant:this.getStyleProperty(a,"font-variant")};return b},enableDragDrop:function(){lDivX=parseInt(perfectfont.getStyleProperty(perfectfont.dom.window,"left")),lDivY=parseInt(perfectfont.getStyleProperty(perfectfont.dom.window,"top")),this.dom.header.onmousedown=function(a){move=!0,mouseX=a.clientX,mouseY=a.clientY,(perfectfont.config.docked||perfectfont.config.maximized)&&(move=!1)},document.body.onmouseup=function(){move=!1,perfectfont.dom.window.style.opacity=perfectfont.config.transparent?.7:1},document.body.onmousemove=function(a){move&&(perfectfont.dom.window.style.opacity="0.7",lDivX+=a.clientX-mouseX,lDivY+=a.clientY-mouseY,mouseX=a.clientX,mouseY=a.clientY,perfectfont.updatePosition(lDivX,lDivY))}},addAvailableFont:function(a,b){var c='<option  class="perfectfont '+(b?b:"")+'" style="font-family:'+a+' !important">'+a+"</option>";this.dom.available.innerHTML+=c,this.dom.available.size+=1},addFontToList:function(a,b){var c;c=b?'<li id="'+preId+a.id+'" onclick="perfectfont.showUsedFontPreferences(this, true)"><p class="perfectfont" style="font-family:'+a.fontName+'">#'+a.id+'</p><span class="perfectfont">'+a.originFontName+"</span></li>":'<li id="'+preId+a.id+'" onclick="perfectfont.showUsedFontPreferences(this)"><p class="perfectfont" style="font-family:'+a.fontName+'">'+a.fontName+'</p><span class="perfectfont">'+a.originFontName+"</span></li>",this.dom.list.innerHTML+=c,this.dom.list.childNodes[this.dom.list.childNodes.length-1].click(),this.dom.list.scrollTop=this.dom.list.childNodes[this.dom.list.childNodes.length-1].offsetTop-this.dom.list.offsetHeight-14},addSelectionToList:function(){var a=window.getSelection();if(a.rangeCount>0){var b=a.getRangeAt(0),c=b.extractContents(),d=document.createElement("span");d.id="selection"+this.selectionUsedFonts.length,d.appendChild(c);{d.innerHTML}b.insertNode(d);var e=this.generateFontDetails(d),f=new UsedFont,g=perfectfont.getRenderedFont(this.getStyleProperty(d,"font-family"));f.init(d.id,g,e),f.addDomElement(d),this.selectionUsedFonts.push(f),this.addFontToList(f,!0)}else alert("You need to select something in order to add it to the list")},setSelectedUsedFont:function(a,b){this.selectedUsedFontId=a.id.replace(preId,""),this.selectedUsedFont=b?this.selectionUsedFonts[this.selectedUsedFontId.replace("selection","")]:this.usedFonts[this.selectedUsedFontId],document.getElementsByClassName(preId+"selected").length>0&&document.getElementsByClassName(preId+"selected")[0].classList.remove(preId+"selected"),a.classList.add("perfectfont-selected")},showUsedFontPreferences:function(a,b){this.setSelectedUsedFont(a,b),"normal"==this.selectedUsedFont.fontDetails.fontWeight&&(this.selectedUsedFont.fontDetails.fontWeight=400),valueIds.forEach(function(a){perfectfont.dom[a].value=parseFloat(perfectfont.selectedUsedFont.fontDetails[a])})},filterAvailableFonts:function(a){var b;a.classList.contains("active")?(a.classList.remove("active"),b="none"):(a.classList.add("active"),b="block");for(var c=this.dom.available.getElementsByClassName(a.innerHTML),d=0;d<c.length;++d)c[d].style.setProperty("display",b)},searchAvailableFont:function(a,b){for(var c=this.dom.available.childNodes,d=0;d<c.length;++d)-1!=c[d].innerHTML.toLowerCase().indexOf(b.toLowerCase())?c[d].style.setProperty("display","block"):c[d].style.setProperty("display","none")},toggleTransparency:function(){this.config.transparent?this.dom.window.style.setProperty("opacity",1):this.dom.window.style.setProperty("opacity",.4),this.config.transparent=!this.config.transparent},getElementsWithInnerText:function(){for(var a=document.body.querySelectorAll("*"),b=[],c=a.length,d=0;c>d;++d)(""!=a[d].innerText||void 0!=a[d].innerText)&&b.push(a[d]);return b},getStyleProperty:function(a,b){return window.getComputedStyle(a).getPropertyValue(b)},getGoogleWebFonts:function(a,b,c,d,e){this.loadGoogleWebFonts(function(f){for(var g=function(a,b){var c=!0;for(var d in f[b])c||(a.href+="|"),c=!1,a.href+=d.replace(/ /g,"+"),""!=f[b][d]&&(a.href+=":"+f[b][d]),perfectfont.addAvailableFont(d,b)},h=[a,b,c,d,e],i=0;i<h.length;++i)if(h[i]){var j=document.createElement("link");j.rel="stylesheet",j.type="text/css",j.href="http://fonts.googleapis.com/css?family=",g(j,fontStyles[i]),j.href+="&subset=latin,latin-ext,greek-ext,greek,devanagari,cyrillic,cyrillic-ext,vietnamese",document.head.appendChild(j)}})},loadGoogleWebFonts:function(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){for(var c=JSON.parse(b.responseText),d={serif:{},"sans-serif":{},display:{},handwriting:{},monospace:{}},e=0;e<c.items.length;++e){for(var f=c.items[e],g="",h=0;h<f.variants.length;++h)"italic"==f.variants[h]&&(f.variants[h]="400italic"),g+=f.variants[h].replace("regular","400")+",";d[f.category][f.family]=g.substr(0,g.length-1)}a(d)}},b.open("GET","https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyAu2_VZaGnLwopNWh8AWwDX3_aYUacza-Q",!0),b.send()},isAvailableFont:function(a){return checkfont(a)},getRenderedFont:function(a){var b=a.split(",");for(var c in b)if(this.isAvailableFont(b[c])){a=b[c].replace(/'/g,"");break}return a.replace(/'/g,"")},updateUsedFont:function(a){this.selectedUsedFont.updateFontName(a.value),-1==document.getElementsByClassName(preId+"selected")[0].id.indexOf("selection")&&(document.getElementsByClassName(preId+"selected")[0].childNodes[0].innerHTML=a.value),document.getElementsByClassName(preId+"selected")[0].childNodes[0].style.setProperty("font-family",a.value)},updateUsedFontDetail:function(a){this.selectedUsedFont.updateFontDetails(a.id.replace(preId,""),a.value)},resizeHeight:function(a){var b=a-this.dom.header.offsetHeight,c=b-this.dom["available-container"].childNodes[0].offsetHeight-this.dom["search-container"].offsetHeight,d=b-2*this.dom.selection.offsetHeight-this.dom["toggle-transparency"].offsetHeight;this.dom.window.style.setProperty("height",a+"px"),this.dom["list-container"].style.setProperty("height",d+"px"),this.dom.detail.style.setProperty("height",b+"px"),this.dom["available-container"].style.setProperty("height",b+"px"),this.dom.available.style.setProperty("height",c+"px");var e=this.dom.fontSize.offsetHeight;this.dom.color.style.setProperty("height",e+"px")},resizeWidth:function(a){this.dom.window.style.setProperty("width",a+"px")},updatePosition:function(a,b){this.dom.window.style.setProperty("left",a+"px"),this.dom.window.style.setProperty("top",b+"px")},maximize:function(){this.config.maximized?(this.resizeWidth(600),this.resizeHeight(400),this.updatePosition(lDivX,lDivY)):(this.resizeWidth(window.innerWidth),this.resizeHeight(window.innerHeight+1),this.updatePosition(0,0)),this.config.maximized=!this.config.maximized},dock:function(a){var b=!1;if(this.config.docked==a)this.resizeWidth(600),this.resizeHeight(400),this.updatePosition(lDivX,lDivY),b=!1;else switch(b=a,a){case"left":this.updatePosition(0,0),this.resizeHeight(window.innerHeight),this.resizeWidth(600);break;case"right":this.updatePosition(window.innerWidth-600,0),this.resizeHeight(window.innerHeight),this.resizeWidth(600);break;case"top":this.updatePosition(0,0),this.resizeHeight(400),this.resizeWidth(window.innerWidth);break;default:this.dock("right")}this.config.docked=b},dockLeft:function(){this.dock("left")},dockTop:function(){this.dock("top")},dockRight:function(){this.dock("right")},show:function(){this.dom.window.style.setProperty("display","block"),this.dom.list.style.height||this.resizeHeight(this.dom.window.offsetHeight)},close:function(){this.dom.window.style.setProperty("display","none")}},perfectFontControlButton={show:function(){},hide:function(){}},UsedFont=function(){this.init=function(a,b,c){this.id=a,this.domElements=[],this.fontDetails=c,this.fontName=b,this.originFontName=b},this.addDomElement=function(a){this.domElements.push(a)},this.removeDomElement=function(a){this.domElements.splice(this.domElements.indexOf(a),1)},this.updateFontName=function(a){this.fontName=a;for(var b=0;b<this.domElements.length;++b)this.domElements[b].style.setProperty("font-family",this.fontName)},this.updateFontDetails=function(a,b){this.fontDetails[a]=b;for(var c=0;c<this.domElements.length;++c)("fontSize"==a||"letterSpacing"==a||"wordSpacing"==a||"lineHeight"==a)&&(b+="px"),this.domElements[c].style[a]=b}},fontchecker_a,fontchecker_b;